<!doctype html>
<html class="no-js">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>runTest</title>
<link href="../../images/logo-icon.svg" rel="icon" type="image/svg">    <script>var pathToRoot = "../../";</script>
    <script>document.documentElement.classList.replace("no-js","js");</script>
    <script>const storage = localStorage.getItem("dokka-dark-mode")
    if (storage == null) {
        const osDarkSchemePreferred = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        if (osDarkSchemePreferred === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    } else {
        const savedDarkMode = JSON.parse(storage)
        if(savedDarkMode === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    }
    </script>
<script type="text/javascript" src="../../scripts/sourceset_dependencies.js" async></script>
<link href="../../styles/style.css" rel="Stylesheet">
<link href="../../styles/main.css" rel="Stylesheet">
<link href="../../styles/prism.css" rel="Stylesheet">
<link href="../../styles/logo-styles.css" rel="Stylesheet">
<link href="../../styles/font-jb-sans-auto.css" rel="Stylesheet">
<script type="text/javascript" src="../../scripts/clipboard.js" async></script>
<script type="text/javascript" src="../../scripts/navigation-loader.js" async></script>
<script type="text/javascript" src="../../scripts/platform-content-handler.js" async></script>
<script type="text/javascript" src="../../scripts/main.js" defer></script>
<script type="text/javascript" src="../../scripts/prism.js" async></script>
<script type="text/javascript" src="../../scripts/symbol-parameters-wrapper_deferred.js" defer></script></head>
<body>
    <div class="root">
<nav class="navigation" id="navigation-wrapper">
    <div class="navigation--inner">
        <div class="navigation-title">
            <button class="menu-toggle" id="menu-toggle" type="button">toggle menu</button>
            <div class="library-name">
<a class="library-name--link" href="../../index.html">
                            kotlinx.coroutines
                    </a>            </div>
            <div class="library-version">1.7.1-SNAPSHOT
            </div>
        </div>
        <div class="filter-section" id="filter-section">
                <button class="platform-tag platform-selector common-like" data-active="" data-filter=":kotlinx-coroutines-test:dokkaHtmlPartial/commonMain">common</button>
                <button class="platform-tag platform-selector jvm-like" data-active="" data-filter=":kotlinx-coroutines-test:dokkaHtmlPartial/jvmMain">jvm</button>
        </div>
    </div>
    <div class="navigation-controls">
        <button class="navigation-controls--btn navigation-controls--theme" id="theme-toggle-button" type="button">switch theme</button>
        <div class="navigation-controls--btn navigation-controls--search" id="searchBar" role="button">search in API</div>
    </div>
</nav>
        <div id="container">
            <div class="sidebar" id="leftColumn">
                <div class="sidebar--inner" id="sideMenu"></div>
            </div>
            <div id="main">
<div class="main-content" data-page-type="member" id="content" pageids="kotlinx-coroutines-test::kotlinx.coroutines.test//runTest/#kotlin.coroutines.CoroutineContext#kotlin.time.Duration#kotlin.coroutines.SuspendFunction1[kotlinx.coroutines.test.TestScope,kotlin.Unit]/PointingToDeclaration//670877716">
  <div class="breadcrumbs"><a href="../index.html">kotlinx-coroutines-test</a><span class="delimiter">/</span><a href="index.html">kotlinx.coroutines.test</a><span class="delimiter">/</span><span class="current">runTest</span></div>
  <div class="cover ">
    <h1 class="cover"><span>run</span><wbr><span><span>Test</span></span></h1>
  </div>
  <div class="platform-hinted  with-platform-tabs" data-platform-hinted="data-platform-hinted">
    <div class="platform-bookmarks-row" data-toggle-list="data-toggle-list"><button class="platform-bookmark" data-filterable-current=":kotlinx-coroutines-test:dokkaHtmlPartial/commonMain" data-filterable-set=":kotlinx-coroutines-test:dokkaHtmlPartial/commonMain" data-active="" data-toggle=":kotlinx-coroutines-test:dokkaHtmlPartial/commonMain">common</button><button class="platform-bookmark" data-filterable-current=":kotlinx-coroutines-test:dokkaHtmlPartial/jvmMain" data-filterable-set=":kotlinx-coroutines-test:dokkaHtmlPartial/jvmMain" data-toggle=":kotlinx-coroutines-test:dokkaHtmlPartial/jvmMain">jvm</button></div>
<div class="content sourceset-dependent-content" data-active="" data-togglable=":kotlinx-coroutines-test:dokkaHtmlPartial/commonMain"><div class="symbol monospace"><span class="token keyword"></span><span class="token keyword">fun </span><a href="run-test.html"><span class="token function">runTest</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter ">context<span class="token operator">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html">CoroutineContext</a><span class="token operator"> = </span>EmptyCoroutineContext<span class="token punctuation">, </span></span><span class="parameter ">timeout<span class="token operator">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.time/-duration/index.html">Duration</a><span class="token operator"> = </span>DEFAULT_TIMEOUT<span class="token punctuation">, </span></span><span class="parameter ">testBody<span class="token operator">: </span><span class="token keyword">suspend </span><span class="token keyword"></span><a href="-test-scope/index.html">TestScope</a><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator"> -&gt; </span><span class="token keyword"></span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html">Unit</a></span></span><span class="token punctuation">)</span><span class="token operator">: </span><a href="-test-result/index.html">TestResult</a></div><p class="paragraph">Executes <a href="run-test.html">testBody</a> as a test in a new coroutine, returning <a href="-test-result/index.html">TestResult</a>.</p><p class="paragraph">On JVM and Native, this function behaves similarly to <code class="lang-kotlin">runBlocking</code>, with the difference that the code that it runs will skip delays. This allows to use <a href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/index.html">delay</a> in tests without causing them to take more time than necessary. On JS, this function creates a <code class="lang-kotlin">Promise</code> that executes the test body with the delay-skipping behavior.</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">@Test<br>fun exampleTest() = runTest {<br>    val deferred = async {<br>        delay(1.seconds)<br>        async {<br>            delay(1.seconds)<br>        }.await()<br>    }<br><br>    deferred.await() // result available immediately<br>}</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><p class="paragraph">The platform difference entails that, in order to use this function correctly in common code, one must always immediately return the produced <a href="-test-result/index.html">TestResult</a> from the test method, without doing anything else afterwards. See <a href="-test-result/index.html">TestResult</a> for details on this.</p><p class="paragraph">The test is run on a single thread, unless other <a href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-coroutine-dispatcher/index.html">CoroutineDispatcher</a> are used for child coroutines. Because of this, child coroutines are not executed in parallel to the test body. In order for the spawned-off asynchronous code to actually be executed, one must either <a href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/index.html">yield</a> or suspend the test body some other way, or use commands that control scheduling (see <a href="-test-coroutine-scheduler/index.html">TestCoroutineScheduler</a>).</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">@Test<br>fun exampleWaitingForAsyncTasks1() = runTest {<br>    // 1<br>    val job = launch {<br>        // 3<br>    }<br>    // 2<br>    job.join() // the main test coroutine suspends here, so the child is executed<br>    // 4<br>}<br><br>@Test<br>fun exampleWaitingForAsyncTasks2() = runTest {<br>    // 1<br>    launch {<br>        // 3<br>    }<br>    // 2<br>    testScheduler.advanceUntilIdle() // runs the tasks until their queue is empty<br>    // 4<br>}</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><h3 class=""> Task scheduling</h3><p class="paragraph">Delay skipping is achieved by using virtual time. If <a href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-dispatchers/-main.html">Dispatchers.Main</a> is set to a <a href="-test-dispatcher/index.html">TestDispatcher</a> via <a href="set-main.html">Dispatchers.setMain</a> before the test, then its <a href="-test-coroutine-scheduler/index.html">TestCoroutineScheduler</a> is used; otherwise, a new one is automatically created (or taken from <a href="run-test.html">context</a> in some way) and can be used to control the virtual time, advancing it, running the tasks scheduled at a specific time etc. The scheduler can be accessed via <a href="-test-scope/test-scheduler.html">TestScope.testScheduler</a>.</p><p class="paragraph">Delays in code that runs inside dispatchers that don't use a <a href="-test-coroutine-scheduler/index.html">TestCoroutineScheduler</a> don't get skipped:</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">@Test<br>fun exampleTest() = runTest {<br>    val elapsed = TimeSource.Monotonic.measureTime {<br>        val deferred = async {<br>            delay(1.seconds) // will be skipped<br>            withContext(Dispatchers.Default) {<br>                delay(5.seconds) // Dispatchers.Default doesn't know about TestCoroutineScheduler<br>            }<br>        }<br>        deferred.await()<br>    }<br>    println(elapsed) // about five seconds<br>}</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><h3 class=""> Failures</h3><h4 class=""> Test body failures</h4><p class="paragraph">If the created coroutine completes with an exception, then this exception will be thrown at the end of the test.</p><h4 class=""> Timing out</h4><p class="paragraph">There's a built-in timeout of 10 seconds for the test body. If the test body doesn't complete within this time, then the test fails with an <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-assertion-error/index.html">AssertionError</a>. The timeout can be changed by setting the <a href="run-test.html">timeout</a> parameter.</p><p class="paragraph">On timeout, the test body is cancelled so that the test finishes. If the code inside the test body does not respond to cancellation, the timeout will not be able to make the test execution stop. In that case, the test will hang despite the attempt to terminate it.</p><p class="paragraph">On the JVM, if <code class="lang-kotlin">DebugProbes</code> from the <code class="lang-kotlin">kotlinx-coroutines-debug</code> module are installed, the current dump of the coroutines' stack is printed to the console on timeout before the test body is cancelled.</p><h4 class=""> Reported exceptions</h4><p class="paragraph">Unhandled exceptions will be thrown at the end of the test. If uncaught exceptions happen after the test finishes, they are propagated in a platform-specific manner: see <a href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/index.html">handleCoroutineException</a> for details. If the test coroutine completes with an exception, the unhandled exceptions are suppressed by it.</p><h4 class=""> Uncompleted coroutines</h4><p class="paragraph">Otherwise, the test will hang until all the coroutines launched inside <a href="run-test.html">testBody</a> complete. This may be an issue when there are some coroutines that are not supposed to complete, like infinite loops that perform some background work and are supposed to outlive the test. In that case, <a href="-test-scope/background-scope.html">TestScope.backgroundScope</a> can be used to launch such coroutines. They will be cancelled automatically when the test finishes.</p><h3 class=""> Configuration</h3><p class="paragraph"><a href="run-test.html">context</a> can be used to affect the environment of the code under test. Beside just being passed to the coroutine scope created for the test, <a href="run-test.html">context</a> also can be used to change how the test is executed. See the <a href="-test-scope/index.html">TestScope</a> constructor function documentation for details.</p><h4 class="">Throws</h4><div class="table"><div class="table-row" data-filterable-current=":kotlinx-coroutines-test:dokkaHtmlPartial/commonMain" data-filterable-set=":kotlinx-coroutines-test:dokkaHtmlPartial/commonMain"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><div><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-illegal-argument-exception/index.html"><span>Illegal</span><wbr><span>Argument</span><wbr><span><span>Exception</span></span></a></div></span></div><div><div class="title"><p class="paragraph">if the <a href="run-test.html">context</a> is invalid. See the <a href="-test-scope/index.html">TestScope</a> constructor docs for details.</p></div></div></div></div></div><hr><div class="symbol monospace"><span class="token keyword"></span><span class="token keyword">fun </span><a href="-test-scope/index.html">TestScope</a><span class="token punctuation">.</span><a href="run-test.html"><span class="token function">runTest</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter ">timeout<span class="token operator">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.time/-duration/index.html">Duration</a><span class="token operator"> = </span>DEFAULT_TIMEOUT<span class="token punctuation">, </span></span><span class="parameter ">testBody<span class="token operator">: </span><span class="token keyword">suspend </span><span class="token keyword"></span><a href="-test-scope/index.html">TestScope</a><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator"> -&gt; </span><span class="token keyword"></span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html">Unit</a></span></span><span class="token punctuation">)</span><span class="token operator">: </span><a href="-test-result/index.html">TestResult</a></div><p class="paragraph">Performs <a href="run-test.html">runTest</a> on an existing <a href="-test-scope/index.html">TestScope</a>. See the documentation for <a href="run-test.html">runTest</a> for details.</p><hr><div class="symbol monospace"><span class="token keyword"></span><span class="token keyword">fun </span><a href="run-test.html"><span class="token function"><strike>runTest</strike></span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter ">context<span class="token operator">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html">CoroutineContext</a><span class="token operator"> = </span>EmptyCoroutineContext<span class="token punctuation">, </span></span><span class="parameter ">dispatchTimeoutMs<span class="token operator">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html">Long</a><span class="token punctuation">, </span></span><span class="parameter ">testBody<span class="token operator">: </span><span class="token keyword">suspend </span><span class="token keyword"></span><a href="-test-scope/index.html">TestScope</a><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator"> -&gt; </span><span class="token keyword"></span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html">Unit</a></span></span><span class="token punctuation">)</span><span class="token operator">: </span><a href="-test-result/index.html">TestResult</a></div><div class="deprecation-content"><h3 class="">Deprecated</h3><p class="paragraph">Define a total timeout for the whole test instead of using dispatchTimeoutMs. Warning: the proposed replacement is not identical as it uses 'dispatchTimeoutMs' as the timeout for the whole test!</p><h4 class="">Replace with</h4><div class="sample-container"><pre><code class="monospace block lang-kotlin" theme="idea">import kotlin.time.Duration.Companion.milliseconds<br></code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><div class="sample-container"><pre><code class="monospace block lang-kotlin" theme="idea">runTest(context, timeout = dispatchTimeoutMs.milliseconds, testBody)</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div></div><p class="paragraph">Executes <a href="run-test.html">testBody</a> as a test in a new coroutine, returning <a href="-test-result/index.html">TestResult</a>.</p><p class="paragraph">On JVM and Native, this function behaves similarly to <code class="lang-kotlin">runBlocking</code>, with the difference that the code that it runs will skip delays. This allows to use <a href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/index.html">delay</a> in without causing the tests to take more time than necessary. On JS, this function creates a <code class="lang-kotlin">Promise</code> that executes the test body with the delay-skipping behavior.</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">@Test<br>fun exampleTest() = runTest {<br>    val deferred = async {<br>        delay(1.seconds)<br>        async {<br>            delay(1.seconds)<br>        }.await()<br>    }<br><br>    deferred.await() // result available immediately<br>}</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><p class="paragraph">The platform difference entails that, in order to use this function correctly in common code, one must always immediately return the produced <a href="-test-result/index.html">TestResult</a> from the test method, without doing anything else afterwards. See <a href="-test-result/index.html">TestResult</a> for details on this.</p><p class="paragraph">The test is run in a single thread, unless other <a href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-coroutine-dispatcher/index.html">CoroutineDispatcher</a> are used for child coroutines. Because of this, child coroutines are not executed in parallel to the test body. In order for the spawned-off asynchronous code to actually be executed, one must either <a href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/index.html">yield</a> or suspend the test body some other way, or use commands that control scheduling (see <a href="-test-coroutine-scheduler/index.html">TestCoroutineScheduler</a>).</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">@Test<br>fun exampleWaitingForAsyncTasks1() = runTest {<br>    // 1<br>    val job = launch {<br>        // 3<br>    }<br>    // 2<br>    job.join() // the main test coroutine suspends here, so the child is executed<br>    // 4<br>}<br><br>@Test<br>fun exampleWaitingForAsyncTasks2() = runTest {<br>    // 1<br>    launch {<br>        // 3<br>    }<br>    // 2<br>    advanceUntilIdle() // runs the tasks until their queue is empty<br>    // 4<br>}</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><h3 class=""> Task scheduling</h3><p class="paragraph">Delay-skipping is achieved by using virtual time. If <a href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-dispatchers/-main.html">Dispatchers.Main</a> is set to a <a href="-test-dispatcher/index.html">TestDispatcher</a> via <a href="set-main.html">Dispatchers.setMain</a> before the test, then its <a href="-test-coroutine-scheduler/index.html">TestCoroutineScheduler</a> is used; otherwise, a new one is automatically created (or taken from <a href="run-test.html">context</a> in some way) and can be used to control the virtual time, advancing it, running the tasks scheduled at a specific time etc. Some convenience methods are available on <a href="-test-scope/index.html">TestScope</a> to control the scheduler.</p><p class="paragraph">Delays in code that runs inside dispatchers that don't use a <a href="-test-coroutine-scheduler/index.html">TestCoroutineScheduler</a> don't get skipped:</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">@Test<br>fun exampleTest() = runTest {<br>    val elapsed = TimeSource.Monotonic.measureTime {<br>        val deferred = async {<br>            delay(1.seconds) // will be skipped<br>            withContext(Dispatchers.Default) {<br>                delay(5.seconds) // Dispatchers.Default doesn't know about TestCoroutineScheduler<br>            }<br>        }<br>        deferred.await()<br>    }<br>    println(elapsed) // about five seconds<br>}</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><h3 class=""> Failures</h3><h4 class=""> Test body failures</h4><p class="paragraph">If the created coroutine completes with an exception, then this exception will be thrown at the end of the test.</p><h4 class=""> Reported exceptions</h4><p class="paragraph">Unhandled exceptions will be thrown at the end of the test. If the uncaught exceptions happen after the test finishes, the error is propagated in a platform-specific manner. If the test coroutine completes with an exception, the unhandled exceptions are suppressed by it.</p><h4 class=""> Uncompleted coroutines</h4><p class="paragraph">This method requires that, after the test coroutine has completed, all the other coroutines launched inside <a href="run-test.html">testBody</a> also complete, or are cancelled. Otherwise, the test will be failed (which, on JVM and Native, means that <a href="run-test.html">runTest</a> itself will throw <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-assertion-error/index.html">AssertionError</a>, whereas on JS, the <code class="lang-kotlin">Promise</code> will fail with it).</p><p class="paragraph">In the general case, if there are active jobs, it's impossible to detect if they are going to complete eventually due to the asynchronous nature of coroutines. In order to prevent tests hanging in this scenario, <a href="run-test.html">runTest</a> will wait for <a href="run-test.html">dispatchTimeoutMs</a> from the moment when <a href="-test-coroutine-scheduler/index.html">TestCoroutineScheduler</a> becomes idle before throwing <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-assertion-error/index.html">AssertionError</a>. If some dispatcher linked to <a href="-test-coroutine-scheduler/index.html">TestCoroutineScheduler</a> receives a task during that time, the timer gets reset.</p><h3 class=""> Configuration</h3><p class="paragraph"><a href="run-test.html">context</a> can be used to affect the environment of the code under test. Beside just being passed to the coroutine scope created for the test, <a href="run-test.html">context</a> also can be used to change how the test is executed. See the <a href="-test-scope/index.html">TestScope</a> constructor function documentation for details.</p><h4 class="">Throws</h4><div class="table"><div class="table-row" data-filterable-current=":kotlinx-coroutines-test:dokkaHtmlPartial/commonMain" data-filterable-set=":kotlinx-coroutines-test:dokkaHtmlPartial/commonMain"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><div><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-illegal-argument-exception/index.html"><span>Illegal</span><wbr><span>Argument</span><wbr><span><span>Exception</span></span></a></div></span></div><div><div class="title"><p class="paragraph">if the <a href="run-test.html">context</a> is invalid. See the <a href="-test-scope/index.html">TestScope</a> constructor docs for details.</p></div></div></div></div></div><hr><div class="symbol monospace"><span class="token keyword"></span><span class="token keyword">fun </span><a href="-test-scope/index.html">TestScope</a><span class="token punctuation">.</span><a href="run-test.html"><span class="token function"><strike>runTest</strike></span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter ">dispatchTimeoutMs<span class="token operator">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html">Long</a><span class="token punctuation">, </span></span><span class="parameter ">testBody<span class="token operator">: </span><span class="token keyword">suspend </span><span class="token keyword"></span><a href="-test-scope/index.html">TestScope</a><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator"> -&gt; </span><span class="token keyword"></span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html">Unit</a></span></span><span class="token punctuation">)</span><span class="token operator">: </span><a href="-test-result/index.html">TestResult</a></div><div class="deprecation-content"><h3 class="">Deprecated</h3><p class="paragraph">Define a total timeout for the whole test instead of using dispatchTimeoutMs. Warning: the proposed replacement is not identical as it uses 'dispatchTimeoutMs' as the timeout for the whole test!</p><h4 class="">Replace with</h4><div class="sample-container"><pre><code class="monospace block lang-kotlin" theme="idea">import kotlin.time.Duration.Companion.milliseconds<br></code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><div class="sample-container"><pre><code class="monospace block lang-kotlin" theme="idea">this.runTest(timeout = dispatchTimeoutMs.milliseconds, testBody)</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div></div><p class="paragraph">Performs <a href="run-test.html">runTest</a> on an existing <a href="-test-scope/index.html">TestScope</a>.</p><p class="paragraph">In the general case, if there are active jobs, it's impossible to detect if they are going to complete eventually due to the asynchronous nature of coroutines. In order to prevent tests hanging in this scenario, <a href="run-test.html">runTest</a> will wait for <a href="run-test.html">dispatchTimeoutMs</a> from the moment when <a href="-test-coroutine-scheduler/index.html">TestCoroutineScheduler</a> becomes idle before throwing <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-assertion-error/index.html">AssertionError</a>. If some dispatcher linked to <a href="-test-coroutine-scheduler/index.html">TestCoroutineScheduler</a> receives a task during that time, the timer gets reset.</p></div><div class="content sourceset-dependent-content" data-togglable=":kotlinx-coroutines-test:dokkaHtmlPartial/jvmMain"><div class="symbol monospace"><div class="block"><div class="block"><span class="token annotation builtin">@</span><a href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-experimental-coroutines-api/index.html"><span class="token annotation builtin">ExperimentalCoroutinesApi</span></a></div></div><span class="token keyword"></span><span class="token keyword">fun </span><a href="-test-coroutine-scope/index.html">TestCoroutineScope</a><span class="token punctuation">.</span><a href="run-test.html"><span class="token function"><strike>runTest</strike></span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter ">dispatchTimeoutMs<span class="token operator">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html">Long</a><span class="token operator"> = </span>DEFAULT_DISPATCH_TIMEOUT_MS<span class="token punctuation">, </span></span><span class="parameter ">block<span class="token operator">: </span><span class="token keyword">suspend </span><span class="token keyword"></span><a href="-test-coroutine-scope/index.html">TestCoroutineScope</a><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator"> -&gt; </span><span class="token keyword"></span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html">Unit</a></span></span><span class="token punctuation">)</span><span class="token operator">: </span><a href="-test-result/index.html">TestResult</a></div><div class="deprecation-content"><h3 class="">Deprecated</h3><p class="paragraph">Use `TestScope.runTest` instead.</p></div><p class="paragraph">Runs a test in a <a href="-test-coroutine-scope/index.html">TestCoroutineScope</a> based on this one.</p><p class="paragraph">Calls <a href="run-test.html">runTest</a> using a coroutine context from this <a href="-test-coroutine-scope/index.html">TestCoroutineScope</a>. The <a href="-test-coroutine-scope/index.html">TestCoroutineScope</a> used to run the <a href="run-test.html">block</a> will be different from this one, but will use its <a href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-job/index.html">Job</a> as a parent.</p><p class="paragraph">Since this function returns <a href="-test-result/index.html">TestResult</a>, in order to work correctly on the JS, its result must be returned immediately from the test body. See the docs for <a href="-test-result/index.html">TestResult</a> for details.</p></div>  </div>
</div>
      <div class="footer">
        <span class="go-to-top-icon"><a href="#content" id="go-to-top-link"></a></span><span>© 2023 Copyright</span><span class="pull-right"><span>Generated by </span><a href="https://github.com/Kotlin/dokka"><span>dokka</span><span class="padded-icon"></span></a></span>
      </div>
            </div>
        </div>
    </div>
</body>
</html>

